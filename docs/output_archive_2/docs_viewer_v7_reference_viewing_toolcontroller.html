
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ToolController | Viewer | Autodesk Platform Services</title>
  <link rel="stylesheet" href="../../styles.css">
</head>
<body>
  <div id="nav-sidebar"></div>
  <div id="content">
    <div id="breadCrumbs"><div class="breadcrumb-container"><div class="breadcrumb"><a data-test-id="documentation-breadcrumb-link" data-external-target="documentation-breadcrumb-link" class="breadcrumb-url" href="/developer/documentation">Documentation</a><span class="breadcrumb-separator"> / </span></div><div class="breadcrumb"><a data-test-id="documentation-breadcrumb-link" data-external-target="documentation-breadcrumb-link" class="breadcrumb-url" href="/en/docs/viewer/v7">Viewer</a><span class="breadcrumb-separator"> / </span></div><div class="breadcrumb"><a data-test-id="documentation-breadcrumb-link" data-external-target="documentation-breadcrumb-link" class="breadcrumb-url" href="/en/docs/viewer/v7/reference">Reference Guide</a></div></div></div><div class="title-category">Autodesk.Viewing</div>
<meta name="sphinx-version" content="5.0.0">
            
  <meta name="edit-url" content="https://git.autodesk.com/A360/firefly.js/edit/master/src/tools/ToolController.js">
<section id="toolcontroller">
<h1>ToolController</h1>
<section id="new-toolcontroller-viewerimpl-viewerapi-autocam-utilities-defaulthandler">
<a href="#new-toolcontroller-viewerimpl-viewerapi-autocam-utilities-defaulthandler"><h2>new ToolController(viewerImpl, viewerApi, autocam, utilities, defaultHandler)</h2></a>
<p>Core interface to add and remove canvas interactions to the viewer.</p>
<p>This class is created internally by the Viewer api and is available via the “toolController” property of the Viewer3D api object. Client implementations should not normally instantiate this class directly.</p>
<section id="parameters">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">viewerImpl</span><span class="required">*</span><div class="type">object</div></td><td>The viewer implementation object.</td></tr><tr><td><span class="name">viewerApi</span><span class="required">*</span><div class="type">object</div></td><td>The viewer api object.</td></tr><tr><td><span class="name">autocam</span><span class="required">*</span><div class="type">object</div></td><td>The Autocam interface object.</td></tr><tr><td><span class="name">utilities</span><span class="required">*</span><div class="type">object</div></td><td>The ViewingUtilities object.</td></tr><tr><td><span class="name">defaultHandler</span><span class="required">*</span><div class="type">object</div></td><td>The default event handling tool.</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
</section>
</section>
<section id="methods">
<h1>Methods</h1>
<section id="registertool-tool-onstatechanged">
<a href="#registertool-tool-onstatechanged"><h2>registerTool(tool, onStateChanged)</h2></a>
<p>This method registers an event handling tool with the controller. This makes the tool available for activation and deactivation. Tools are registered under one or more names which must be provided via their “getNames” method. The tools “getNames” method must return an array of one or more names. Typically a tool will only have one name but if it wishes to operate in different modes it can use different names to activate the modes. Registered tools have the properties named “utilities” and “controller” added to them which refer to the ViewingUtilities object and this controller respectively. Tools may not use the name “default” which is reserved.</p>
<section id="id1">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">tool</span><span class="required">*</span><div class="type">object</div></td><td>The tool to be registered.</td></tr><tr><td><span class="name">onStateChanged</span><span class="required">*</span><div class="type">function</div></td><td>callback to be called when disabling the tool through the modality map</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
</section>
<section id="deregistertool-tool">
<a href="#deregistertool-tool"><h2>deregisterTool(tool)</h2></a>
<p>This method deregisters an event handling tool with the controller afterwhich it will no longer be available for activation and deactivation. All names that the tool is registered under will be deregistered. If any tool is active at the time of deregistration will first be deactivated and it’s “deactivate” method will be called.</p>
<section id="id2">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">tool</span><span class="required">*</span><div class="type">object</div></td><td>The tool to be deregistered.</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
</section>
<section id="gettool-name">
<a href="#gettool-name"><h2>getTool(name)</h2></a>
<p>This method returns the tool registered under the given name.</p>
<section id="id3">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">name</span><span class="required">*</span><div class="type">string</div></td><td>The tool name to look up.</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
<section id="returns">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>object</td>
<td>The tool registered under the given name or undefined if not found.</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="getactivetoolname">
<a href="#getactivetoolname"><h2>getActiveToolName()</h2></a>
<p>This method returns the name of the topmost tool on the tool stack. If no tools are active the name of the default tool is returned (which is “default”).</p>
<section id="id4">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>string</td>
<td>The tool name to look up.</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="getactivetool">
<a href="#getactivetool"><h2>getActiveTool()</h2></a>
<p>This method returns the name of the topmost tool on the tool stack. If no tools are active the name of the default tool is returned (which is “default”).</p>
<section id="id5">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>string</td>
<td>The tool name to look up.</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="getactivetools">
<a href="#getactivetools"><h2>getActiveTools()</h2></a>
<p>Return the current tool stack.</p>
<section id="id6">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>Array</td>
<td><ul class="simple">
<li>list of tools in the tool stack</li>
</ul>
</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="rearrangebypriorities">
<a href="#rearrangebypriorities"><h2>rearrangeByPriorities()</h2></a>
<p>Sorts the toolStack according to the tools’ priority. Useful when a tool’s priority gets changed after activation.</p>
</section>
<section id="activatetoolmodality-toolname">
<a href="#activatetoolmodality-toolname"><h2>activateToolModality(toolName)</h2></a>
<p>Disables or enables tools in the tool’s modality map</p>
<section id="id7">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">toolName</span><span class="required">*</span><div class="type">string</div></td><td>Name of the tool</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
</section>
<section id="activatetool-toolname">
<a href="#activatetool-toolname"><h2>activateTool(toolName)</h2></a>
<p>Activates the tool registered under the given name. Activation implies pushing the tool on a stack of “active” tools, each of which (starting from the top of the stack) is given the opportunity to handle incoming events. Tools may “consume” events by returning true from their event handling methods, or they may allow events to be passed down to the next tool on the stack by returning false from the handling methods. Upon activation the tools “activate” method is called with the name under which it has been activated. Activation is not allowed while the controller is in a “locked” state (see the methods “setIsLocked” and “getIsLocked”). Tools must be registered prior to activation (see the methods “registerTool” and “deregisterTool”). Each tool has its own priority property (default 0), such that a tool with higher priority will get events first.</p>
<section id="id8">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">toolName</span><span class="required">*</span><div class="type">string</div></td><td>The name of the tool to be activated.</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
<section id="id9">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>boolean</td>
<td>True if activation was successful.</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="deactivatetool-toolname">
<a href="#deactivatetool-toolname"><h2>deactivateTool(toolName)</h2></a>
<p>The first tool found on the active stack with the given name is removed and its “deactivate” method is called. Once deactivated the tool will no longer receive events via its handler methods. Deactivation is not allowed while the controller is in a “locked” state (see the methods “setIsLocked” and “getIsLocked”).</p>
<section id="id10">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">toolName</span><span class="required">*</span><div class="type">string</div></td><td>The name of the tool to be deactivated.</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
<section id="id11">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>boolean</td>
<td>True if deactivation was successful.</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="gettoolnames">
<a href="#gettoolnames"><h2>getToolNames()</h2></a>
<p>Obtain a list of all the currently registered tool names.</p>
<section id="id12">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>Array</td>
<td>List of all registered tool names.</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="setdefaulttool-tool">
<a href="#setdefaulttool-tool"><h2>setDefaultTool(tool)</h2></a>
<p>Set the tool which will be requested to handle events if no other active tool handles them.</p>
<section id="id13">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">tool</span><span class="required">*</span><div class="type">object</div></td><td>The tool to be registered as the default.</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
</section>
<section id="getdefaulttool">
<a href="#getdefaulttool"><h2>getDefaultTool()</h2></a>
<p>Get the tool which handle events if no other active tool handles them.</p>
<section id="id14">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>object</td>
<td>The tool to be registered as the default.</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="setislocked-state">
<a href="#setislocked-state"><h2>setIsLocked(state)</h2></a>
<p>Set the controller into a locked or unlocked state. While locked, tool activation and deactivation is not allowed. Locking the controller is sometimes necessary to force an interaction to remain active until it is fully completed.</p>
<section id="id15">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">state</span><span class="required">*</span><div class="type">boolean</div></td><td>The state of the controller lock.</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
<section id="id16">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>boolean</td>
<td>The previous state of the lock (this may be used to restore the lock to it’s previous state).</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="getislocked">
<a href="#getislocked"><h2>getIsLocked()</h2></a>
<p>Get the current state of the controller lock.</p>
<section id="id17">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>boolean</td>
<td>The state of the lock.</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="handlecmdkeyevent-cmdevent-eventtype">
<a href="#handlecmdkeyevent-cmdevent-eventtype"><h2>handleCmdKeyEvent(cmdEvent, eventType)</h2></a>
<p>Catches a CMD event and generate a Control one instead.</p>
<section id="id18">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">cmdEvent</span><span class="required">*</span><div class="type">object</div></td><td>Event generated by CMD key</td></tr><tr><td><span class="name">eventType</span><span class="required">*</span><div class="type">string</div></td><td>Event type</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
</section>
<section id="setmousewheelinputenabled-isenabled">
<a href="#setmousewheelinputenabled-isenabled"><h2>setMouseWheelInputEnabled(isEnabled)</h2></a>
<p>Whether mouse scroll wheel (and/or two-finger vertical swipe) will trigger a camera zoom operation.</p>
<section id="id19">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">isEnabled</span><span class="required">*</span><div class="type">boolean</div></td><td></td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
</section>
<section id="setmodalitymap-map">
<a href="#setmodalitymap-map"><h2>setModalityMap(map)</h2></a>
<p>Set the modality map for each tool. This function will clear any existing modality map. The map object consists of a key which represents the tool name and a value which is an object that represents which tools to enable and disable. To get the tool names @see <a class="reference external" href="/en/docs/viewer/v7/reference/Viewing/ToolController/#getToolNames/">Autodesk.Viewing.ToolController#getToolNames</a></p>
<section id="id20">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">map</span><span class="required">*</span><div class="type">object</div></td><td>Object describing each tool’s modality with other tools.</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
<section id="examples">
<h3>Examples</h3>
<div class="highlight-javascript notranslate x-snippet-block x-snippet-block--height-default margin-bottom-3"><div class="highlight snippet-container margin-bottom-0 pad-bottom-0">
          <div class="highlight">
            <button class="copy-button" onclick="copyToClipboard(this)">Copy</button>
            <pre><code><span></span><span class="c1">// When enabling the measure tool the explode, bimwalk and section tools will be disabled.</span>
</code></pre>
          </div>
        </div><div class="clipboard-container" data-original-title="" title=""><i class="fui-icon fui-icon-copy clipboard-icon"></i></div>
</div>
<p>// When enabling the section tool the pan tool will be disabled.
toolController.setModalityMap({</p>
<blockquote>
<div><p>measure: { explode: false, bimwalk: false, section: false },
section: { pan: false }</p>
</div></blockquote>
<p>});</p>
</section>
</section>
<hr class="docutils">
<section id="getmodalitymap">
<a href="#getmodalitymap"><h2>getModalityMap()</h2></a>
<p>Get the modality map.</p>
<section id="id21">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>object</td>
<td><ul class="simple">
<li>returns a copy of the tool modality.</li>
</ul>
</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="gettoolmodality-name">
<a href="#gettoolmodality-name"><h2>getToolModality(name)</h2></a>
<p>Get a specific tool’s modality map.</p>
<section id="id22">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">name</span><span class="required">*</span><div class="type">string</div></td><td>tool name</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
<section id="id23">
<h3>Returns</h3>
<div class="table-section"><table><thead><tr><th>type</th><th>description</th></tr></thead><tbody>
<tr class="row-even"><td>object</td>
<td><ul class="simple">
<li>an object describing the tool’s modality map.</li>
</ul>
</td>
</tr>
</tbody></table></div>
</section>
</section>
<section id="settoolmodality-name-map">
<a href="#settoolmodality-name-map"><h2>setToolModality(name, map)</h2></a>
<section id="id24">
<h3>Parameters</h3>
<div class="table-section"><table><thead></thead><tbody><tr><td><span class="name">name</span><span class="required">*</span><div class="type">string</div></td><td>Tool name that is associated with the modality map.</td></tr><tr><td><span class="name">map</span><span class="required">*</span><div class="type">object</div></td><td>Object containing the name of the tool as the key and a boolean that describes if the tool can be enabled or disabled.</td></tr></tbody></table><div class="text-required">* Required</div></div>
</section>
</section>
</section>


            <div class="clearer"></div>
          
  </div>
  <script src="../../script.js"></script>
</body>
</html>
